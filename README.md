# Telegram-бот для донорского центра НИЯУ МИФИ

Этот проект представляет собой Telegram-бот, созданный для упрощения организации и участия донорства. Бот решает социально значимую задачу: мотивирует студентов, сотрудников и внешних участников сдавать кровь. Он автоматизирует процессы регистрации, отправки напоминаний и ведения статистики.

## Основные функции

### Для пользователей
- **Авторизация**: Регистрация по номеру телефона с валидацией.
- **Профиль**: Просмотр данных о донациях, истории и статусе в ДКМ.
- **Регистрация на события**: Участие в мероприятиях с учетом лимита мест.
- **Информационные разделы**: Доступ к данным о донорстве и ДКМ.
- **Опросы и вопросы**: Возможность указать причины неявки и задать вопросы организаторам.

### Для организаторов
- **Модерация профилей**: Проверка и подтверждение пользовательских данных.
- **Создание событий**: Добавление мероприятий с автоматической рассылкой уведомлений.
- **Статистика**: Импорт и экспорт данных в Excel.
- **Broadcasts**: Массовая рассылка сообщений.
- **Ответы на вопросы**: Обработка запросов от пользователей.

## Нововведения сверх ТЗ
- **Автоматическая модерация**: Проверка профилей с уведомлениями пользователей о статусе.
- **Пагинация**: Удобный просмотр списка пользователей для админов (поддержка баз 500+ участников).
- **Заморозка/разморозка событий**: Гибкое управление доступностью мероприятий.
- **Удобство и безопасность**: Интуитивный интерфейс (кнопки, эмодзи), валидация данных, согласие на обработку данных (consent) и логирование.

Бот протестирован, работает стабильно, без критических ошибок и готов к масштабированию.

## Структура проекта
- **bot.py**: Основной файл для запуска бота (Dispatcher, handlers, scheduler).
- **scheduler.py**: Планировщик задач (напоминания, опросы неявок) на базе библиотеки `schedule`.
- **keyboards.py**: Функции для создания клавиатур (проверка админ-прав через `ADMINS` из `config`).
- **states.py**: Состояния FSM (`ProfilRegStates`, `AddEventStates` и др.).
- **common_handlers.py**: Общие обработчики команд (`/info`, причины неявки).
- **user_handlers.py**: Пользовательские обработчики (`/start`, `/reg`, `/profil`, `/ask` и др.).
- **admin_handlers.py**: Админ-обработчики (`/add_event`, `/broadcast`, `/answer`, статистика).
- **db.py**: Работа с базой данных SQLite (таблицы `users`, `events` и др.; CRUD, импорт/экспорт Excel).
- **config.py**: Хранит `TOKEN` и `ADMINS` (не включен в репозиторий).
- **info_texts/**: Текстовые файлы для команды `/info` (например, `blood_donation.txt`).
- **privacy_policy.pdf**, **frame 3.jpg**: Файлы для приветственного сообщения.
- **donor_bot.txt**: Файл логов.
- **База ДД.xlsx**: Пример Excel-файла для импорта данных.

## Установка и запуск

1. **Инициализация базы данных**:
   - Запустите `bot.py`. Функция `init_db()` создаст файл `donor_bot.db` и, при необходимости, импортирует данные из `База ДД.xlsx` (если таблица пуста).

2. **Запуск бота**:

   - Выполните команду: `python bot.py`.


3. **Настройка**:
  При надобности для тестирования добавьте свой айди в лист администраторов. 

4. **Тестирование**:
   - Убедитесь, что ваш Telegram ID указан в `ADMINS` для доступа к админ-функциям.
   - Проверьте основные команды: `/start`, `/reg`, `/profil`, `/info` (для пользователей) и `/add_event`, `/broadcast` (для админов).



## Примечания
- Бот разработан с учетом удобства использования: интуитивные кнопки, эмодзи и валидация ввода.
- Логирование активности сохраняется в `donor_bot.txt`.
- Для нестандартных ситуаций предусмотрены уведомления и обработка ошибок.
